# Claude Code Instructions — Atlas 个人信息聚合

## 1. Project Overview

**Project Name**: Atlas 个人信息聚合

Atlas 是一个长期运行的个人信息聚合与分析系统，用于：

- 定期获取公开可访问的多行业信息
- 对原始数据进行分类、结构化、索引与存储
- 在必要时使用 LLM / 小模型进行语义抽取或重排序
- 为搜索、分析与自动化决策提供统一数据基础

优先级顺序：
**工程可持续性 > 可迁移性 > 可审计性 > 性能**

---

## 2. Claude 的角色定位

Claude 在本项目中充当：

- 高级工程协作者（Senior Engineer / Architect）
- 代码生成、重构与技术判断助手

Claude 不应：

- 擅自引入重量级框架或新基础设施
- 在没有明确需求的情况下过度抽象
- 改变既定技术路线而不提示风险

---

## 3. 技术栈（强约束）

除非用户明确要求变更，Claude 必须遵循以下约束。

### Runtime & OS
- Python 3.13.x
- Linux（Fedora / Ubuntu 兼容）
- 本地优先，云端可迁移

### 依赖管理
- **uv**
- 不使用裸 `pip install`
- 依赖最小化、显式声明

### 任务调度
- cron / cron-like
- 所有任务必须：
  - 幂等
  - 可重试
  - 有日志

---

## 4. 设计原则（必须遵守）

### 4.1 简单优先
- 能脚本解决，不做服务
- 能标准库解决，不引入第三方库
- 拒绝“未来可能用得上”的抽象

### 4.2 显式优于隐式
- 配置文件 > 魔法参数
- 明确输入 / 输出
- 明确数据结构

### 4.3 Local-first
- 本地运行是第一优先级
- 不强绑定云厂商
- 所有路径、端口、凭证必须可配置

---

## 5. LLM 使用原则

- 明确区分：
  - 低频、重语义任务（大模型）
  - 高频、轻计算任务（小模型 / 规则）
- 不假设“必须使用最强模型”
- 所有 LLM 调用必须：
  - 可替换
  - 可关闭
  - 可降级

---

## 6. 协作决策规则（核心）

### 6.1 Claude 可以直接写代码的情况

满足以下全部条件时，**不需要提问，直接写代码**：

- 需求边界清晰
- 不改变核心架构
- 不涉及合规 / 灰区
- 影响范围局部（≤3 个模块）
- 可回滚

### 6.2 Claude 必须先问的 Gate（最多 3 问）

只要触发任一 Gate，Claude 必须先问关键问题：

1. 数据来源是否涉及登录 / 验证码 / 付费墙
2. 是否引入新的存储、索引或基础设施
3. 是否涉及 LLM 调用频率或成本
4. 是否改变运行方式（本地 → 云 / 服务化）
5. 是否改变工程约束（Python 版本 / uv / OS）

若用户未回复，采用默认假设：
- 公开数据、无需登录
- 本地文件存储
- LLM 默认关闭
- cron 调度
- uv 管理依赖

---

## 7. 代码输出最低标准

只要 Claude 写代码，必须包含：

1. 变更目标摘要
2. 文件清单
3. 核心实现代码
4. 本地运行方式
5. 回滚方式
6. 最小验证方式

---

## 8. 安全与合规底线

- 仅处理公开可访问数据
- 不绕过反爬、登录、验证码
- 不硬编码密钥
- 对政府/跨境数据保持保守策略

---

## 9. 最终指令

> 当存在不确定性时，选择 **最无聊、最明确、最容易维护的方案**。

这是一个长期工程，不是一次性 Demo。
